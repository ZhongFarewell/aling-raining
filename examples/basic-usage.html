<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Aling Rain - 基本使用示例</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        font-family: Arial, sans-serif;
        background: #000;
        color: white;
      }

      .container {
        position: relative;
        width: 100vw;
        height: 100vh;
      }

      #rain-canvas {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }

      .controls {
        position: absolute;
        top: 20px;
        left: 20px;
        z-index: 10;
        background: rgba(0, 0, 0, 0.7);
        padding: 20px;
        border-radius: 8px;
      }

      .controls button {
        margin: 5px;
        padding: 8px 16px;
        background: #007bff;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }

      .controls button:hover {
        background: #0056b3;
      }

      .controls button:disabled {
        background: #6c757d;
        cursor: not-allowed;
      }

      .status {
        margin-top: 10px;
        font-size: 14px;
        color: #ccc;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <canvas id="rain-canvas"></canvas>

      <div class="controls">
        <h3>雨滴效果控制</h3>
        <button id="start-default">使用默认资源</button>
        <button id="start-custom">使用自定义资源</button>
        <button id="start-cdn">使用 CDN 资源</button>
        <button id="stop" disabled>停止效果</button>

        <div class="status" id="status">未初始化</div>
      </div>
    </div>

    <!-- 如果使用 CDN -->
    <script type="module">
      // 示例 1: 使用默认资源
      document.getElementById("start-default").addEventListener("click", async () => {
        try {
          updateStatus("正在加载默认资源...")

          // 假设你已经将库打包并发布到 CDN
          const { loadTextures, abort } = await import(
            "https://unpkg.com/aling-rain@latest/dist/index.js"
          )

          loadTextures("#rain-canvas", {
            onInit: () => {
              updateStatus("默认资源加载完成")
              enableStopButton()
            },
            onAbort: () => {
              updateStatus("效果已停止")
              disableStopButton()
            },
          })
        } catch (error) {
          updateStatus("加载失败: " + error.message)
        }
      })

      // 示例 2: 使用自定义资源
      document.getElementById("start-custom").addEventListener("click", async () => {
        try {
          updateStatus("正在加载自定义资源...")

          const { loadTextures } = await import("https://unpkg.com/aling-rain@latest/dist/index.js")

          loadTextures("#rain-canvas", {
            basePath: "/assets/images/",
            bg: "custom-rain-bg.png",
            fg: "custom-rain-fg.png",
            dropAlpha: "drop-alpha.png",
            dropColor: "drop-color.png",
            onInit: () => {
              updateStatus("自定义资源加载完成")
              enableStopButton()
            },
            onAbort: () => {
              updateStatus("效果已停止")
              disableStopButton()
            },
          })
        } catch (error) {
          updateStatus("加载失败: " + error.message)
        }
      })

      // 示例 3: 使用 CDN 资源
      document.getElementById("start-cdn").addEventListener("click", async () => {
        try {
          updateStatus("正在加载 CDN 资源...")

          const { loadTextures, DEFAULT_ASSETS } = await import(
            "https://unpkg.com/aling-rain@latest/dist/index.js"
          )

          loadTextures("#rain-canvas", {
            ...DEFAULT_ASSETS,
            onInit: () => {
              updateStatus("CDN 资源加载完成")
              enableStopButton()
            },
            onAbort: () => {
              updateStatus("效果已停止")
              disableStopButton()
            },
          })
        } catch (error) {
          updateStatus("加载失败: " + error.message)
        }
      })

      // 停止效果
      document.getElementById("stop").addEventListener("click", async () => {
        try {
          const { abort } = await import("https://unpkg.com/aling-rain@latest/dist/index.js")
          abort()
        } catch (error) {
          updateStatus("停止失败: " + error.message)
        }
      })

      // 工具函数
      function updateStatus(message) {
        document.getElementById("status").textContent = message
      }

      function enableStopButton() {
        document.getElementById("stop").disabled = false
      }

      function disableStopButton() {
        document.getElementById("stop").disabled = true
      }
    </script>

    <!-- 如果使用本地构建 -->
    <!--
    <script type="module">
        import { loadTextures, abort, DEFAULT_ASSETS } from './dist/index.js'
        
        // 使用默认资源
        document.getElementById('start-default').addEventListener('click', () => {
            updateStatus('正在加载默认资源...')
            
            loadTextures('#rain-canvas', {
                onInit: () => {
                    updateStatus('默认资源加载完成')
                    enableStopButton()
                },
                onAbort: () => {
                    updateStatus('效果已停止')
                    disableStopButton()
                }
            })
        })

        // 使用自定义资源
        document.getElementById('start-custom').addEventListener('click', () => {
            updateStatus('正在加载自定义资源...')
            
            loadTextures('#rain-canvas', {
                basePath: '/assets/images/',
                bg: 'custom-rain-bg.png',
                fg: 'custom-rain-fg.png',
                dropAlpha: 'drop-alpha.png',
                dropColor: 'drop-color.png',
                onInit: () => {
                    updateStatus('自定义资源加载完成')
                    enableStopButton()
                },
                onAbort: () => {
                    updateStatus('效果已停止')
                    disableStopButton()
                }
            })
        })

        // 使用 CDN 资源
        document.getElementById('start-cdn').addEventListener('click', () => {
            updateStatus('正在加载 CDN 资源...')
            
            loadTextures('#rain-canvas', {
                ...DEFAULT_ASSETS,
                onInit: () => {
                    updateStatus('CDN 资源加载完成')
                    enableStopButton()
                },
                onAbort: () => {
                    updateStatus('效果已停止')
                    disableStopButton()
                }
            })
        })

        // 停止效果
        document.getElementById('stop').addEventListener('click', () => {
            abort()
        })

        function updateStatus(message) {
            document.getElementById('status').textContent = message
        }

        function enableStopButton() {
            document.getElementById('stop').disabled = false
        }

        function disableStopButton() {
            document.getElementById('stop').disabled = true
        }
    </script>
    -->
  </body>
</html>
